---
layout: post
title: 竞彩足球智能优化
categories: how
own: 原创
---

### 奖金优化

奖金优化是竞技彩投注的一种辅助工具，用户自己选在投注倍数和比赛场次，系统按赔率计算出这些倍数如何分配到每个场次上，进而保证用户平稳盈利。效果图如下：

![奖金优化](/assets/img/blog/how/jczq-bonus.png)

### 算法原理

这个原理在[UI复杂交互的MVVM模型](/flex/2014/08/10/flex-ui.html)一文提及过，在此给出具体的算法。

从上图也不难看出，不管哪场比赛猜中，奖金都在<b class="red">600</b>元左右，即平稳盈利<b class="red">100</b>元左右，这样做的目的就是“求稳”。

然而在计算之前我们不知道这个平均奖金是 <b class="red">600</b>元，所以无法通过奖金确定倍数。有人提议按场次平均分配倍数，然后在迭代增减。虽然没有尝试这种方法，但从心里抵触这种运算，当时我的第一思路是利用最小公倍数和最大公约数来解决这个问题。

360百科给出[最小公倍数](http://baike.so.com/doc/5390805.html)和[最大公约数](http://baike.so.com/doc/5399827.html)的定义

<b>最小公倍数</b>（Least Common Multiple，缩写L.C.M.），如果有一个自然数a能被自然数b整除，则称a为b的倍数，b为a的约数，对于两个整数来说，指该两数共有倍数中最小的一个。计算最小公倍数时，通常会借助最大公约数来辅助计算。

<b>最大公约数</b>也称最大公因数、最大公因子，指两个或多个整数共有约数中最大的一个。a，b的最大公约数记为（a，b），同样的，a，b，c的最大公约数记为（a，b，c），多个整数的最大公约数也有同样的记号。求最大公约数有多种方法，常见的有质因数分解法、短除法、辗转相除法、更相减损法。与最大公约数相对应的概念是最小公倍数，a，b的最小公倍数记为[a，b]。

后来想了想不对，赔率不是整数，分配倍数也是有限的。根据问题的解析，赔率越高，分的倍数理应越小，满足[反比例](http://baike.so.com/doc/5731820.html)关系。公式如下：


<table style="margin-left:2em;">
	<thead>
		<tr>
			<td width="100">序号</td><td width="100">赔率</td><td width="300">分配倍数</td>
		</tr>
	</thead>
	<tbody>
		<tr>
			<td>1</td><td>2.4</td><td>1/2.4/(1/2.4+1/3.2+1/1.8+1/2.5+...+1/1.5)</td>
		</tr>
		<tr>
			<td>2</td><td>3.2</td><td>1/3.2/(1/2.4+1/3.2+1/1.8+1/2.5+...+1/1.5)</td>
		</tr>
		<tr>
			<td>3</td><td>1.8</td><td>1/1.8/(1/2.4+1/3.2+1/1.8+1/2.5+...+1/1.5)</td>
		</tr>
		<tr>
			<td>..</td><td>2.5</td><td>1/2.5/(1/2.4+1/3.2+1/1.8+1/2.5+...+1/1.5)</td>
		</tr>
		<tr>
			<td>n</td><td>1.5</td><td>1/1.5/(1/2.4+1/3.2+1/1.8+1/2.5+...+1/1.5)</td>
		</tr>
	</tbody>
</table>

心细的同学可能发现1/2.4+1/3.2+1/1.8+1/2.5+...+1/1.5不一定等于1。没错，确实不等于1。而且因为每个分的倍数也要取整而且是向下取整，所以最后倍数会有“剩余”。至于这个“剩余”的倍数如何处理要看产品如何要求了。因为“剩余”倍数不大可以遍历递增，也可以直接赋值给“低陪率”或“高赔率”的场次。

### 结束

这块内容和[UI复杂交互的MVVM模型](/flex/2014/08/10/flex-ui.html)一文有相似之处，不附代码了。